<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3 Lab 5 — October 13 | Stat 3553: Regression Modelling</title>
<meta name="author" content="Adam Shen">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="3 Lab 5 — October 13 | Stat 3553: Regression Modelling">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="3 Lab 5 — October 13 | Stat 3553: Regression Modelling">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_IBM%20Plex%20Sans-0.4.0/font.css" rel="stylesheet">
<link href="libs/_IBM%20Plex%20Mono-0.4.0/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-148177428-3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-148177428-3');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><meta name="description" content="3.1 Packages library(tibble) library(dplyr) library(ggplot2) library(tidyr) library(broom) library(ellipse) library(palmerpenguins) theme_set(theme_bw()) The tidyr package is another component...">
<meta property="og:description" content="3.1 Packages library(tibble) library(dplyr) library(ggplot2) library(tidyr) library(broom) library(ellipse) library(palmerpenguins) theme_set(theme_bw()) The tidyr package is another component...">
<meta name="twitter:description" content="3.1 Packages library(tibble) library(dplyr) library(ggplot2) library(tidyr) library(broom) library(ellipse) library(palmerpenguins) theme_set(theme_bw()) The tidyr package is another component...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Fall 2021">Stat 3553: Regression Modelling</a>:
        <small class="text-muted">Fall 2021</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Session info</a></li>
<li><a class="" href="lab-1-september-15.html"><span class="header-section-number">1</span> Lab 1 — September 15</a></li>
<li><a class="" href="lab-3-september-29.html"><span class="header-section-number">2</span> Lab 3 — September 29</a></li>
<li><a class="active" href="lab-5-october-13.html"><span class="header-section-number">3</span> Lab 5 — October 13</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/adamoshen/3553f21">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lab-5-october-13" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Lab 5 — October 13<a class="anchor" aria-label="anchor" href="#lab-5-october-13"><i class="fas fa-link"></i></a>
</h1>
<div id="packages" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Packages<a class="anchor" aria-label="anchor" href="#packages"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ellipse</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The <a href="https://tidyr.tidyverse.org/">tidyr</a> package is another component package of the
<a href="https://www.tidyverse.org/packages/">tidyverse</a> that contains functions for cleaning up and
reshaping data.</p>
<p>The <a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a> package will be used for its
<code>penguins</code> data set for the multiple linear regression example today.</p>
<p>We will be using the package <a href="https://CRAN.R-project.org/package=ellipse">ellipse</a> for drawing
ellipses (confidence regions). This package contains functions for drawing confidence regions
associated to the estimates obtained from linear regression. Unlike the code provided in class for
drawing confidence regions with the component confidence intervals, which took in raw data as input,
the <code><a href="https://rdrr.io/pkg/ellipse/man/ellipse.lm.html">ellipse::ellipse.lm()</a></code> function will allow you to pass in your linear model object instead. In
using the <a href="https://CRAN.R-project.org/package=ellipse">ellipse</a> package, we will however need to
draw the lines corresponding to the component confidence intervals ourselves (though this is not
difficult to do).</p>
</div>
<div id="the-pipe" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> The pipe<a class="anchor" aria-label="anchor" href="#the-pipe"><i class="fas fa-link"></i></a>
</h2>
<p>The pipe operator, <code><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></code>, can be found in the package <a href="https://magrittr.tidyverse.org/">magrittr</a>,
which should have been installed when you installed the <a href="https://dplyr.tidyverse.org/">dplyr</a>
package. When <a href="https://dplyr.tidyverse.org/">dplyr</a> is loaded (by calling <code><a href="https://dplyr.tidyverse.org">library(dplyr)</a></code>),
the <a href="https://magrittr.tidyverse.org/">magrittr</a> pipe is also imported.</p>
<p>The pipe works by taking the result on the left and passing it to the <strong>first</strong> argument of the
function on the right. The pipe allows you to write cleaner code by converting something like this:</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="va">var1</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span>, <span class="va">var2</span>, <span class="va">var3</span><span class="op">)</span>, var4 <span class="op">=</span> <span class="va">var2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">var3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>into this:</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mydata</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">var1</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">var2</span>, <span class="va">var3</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>var4 <span class="op">=</span> <span class="va">var2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">var3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>revealing the underlying sequential logic of your workflow. Since the pipe works by taking the
result on the left and passing it to the <strong>first</strong> argument of the function on the right, the use of
the pipe when wrangling data with <a href="https://dplyr.tidyverse.org/">dplyr</a> is especially convenient as
all <a href="https://dplyr.tidyverse.org/">dplyr</a> data wrangling functions have the data frame argument as
its <strong>first</strong> argument, and in most cases, will return a data frame.</p>
<p>In the example above, the first argument to <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> is a data frame.
After evaluation, each function also returns a data frame. Notice that as a result of piping a data
frame into each of these functions, we don't need to actually specify where it's going (since it
goes to the first argument by default) and we don't need to create extra variables for intermediate
steps.</p>
</div>
<div id="multiple-linear-regression-hypothesis-testing" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Multiple linear regression — hypothesis testing<a class="anchor" aria-label="anchor" href="#multiple-linear-regression-hypothesis-testing"><i class="fas fa-link"></i></a>
</h2>
<div id="the-penguins-data" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> The penguins data<a class="anchor" aria-label="anchor" href="#the-penguins-data"><i class="fas fa-link"></i></a>
</h3>
<p>Let us load the <code>penguins</code> data set. Some of the variables that we are interested in working with
contain missing values. Immediately after loading the data, we can pass it into the <code><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na()</a></code>
function (from <a href="https://tidyr.tidyverse.org/">tidyr</a>) which will drop all rows (observations) that
contain missing values.</p>
<p>In addition, let's also rename some of our variables to shorten some of the code that we need to
type. This can be done by piping our data into the <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> function and supplying name pairs
in the format <code>new_name = old_name</code>.</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu">palmerpenguins</span><span class="fu">::</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html">penguins</a></span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>
    bill_length <span class="op">=</span> <span class="va">bill_length_mm</span>,
    bill_depth <span class="op">=</span> <span class="va">bill_depth_mm</span>,
    flipper_length <span class="op">=</span> <span class="va">flipper_length_mm</span>,
    body_mass <span class="op">=</span> <span class="va">body_mass_g</span>
  <span class="op">)</span>

<span class="va">penguins</span></code></pre></div>
<pre class="fansi fansi-output"><code>## <span style="color: #555555;"># A tibble: 333 x 8</span><span>
##    species island    bill_length bill_depth flipper_length body_mass sex    year
##    </span><span style="color: #555555;font-style: italic;">&lt;fct&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;fct&gt;</span><span>           </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>      </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>          </span><span style="color: #555555;font-style: italic;">&lt;int&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;int&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;fct&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;int&gt;</span><span>
## </span><span style="color: #555555;"> 1</span><span> Adelie  Torgersen        39.1       18.7            181      </span><span style="text-decoration: underline;">3</span><span>750 male   </span><span style="text-decoration: underline;">2</span><span>007
## </span><span style="color: #555555;"> 2</span><span> Adelie  Torgersen        39.5       17.4            186      </span><span style="text-decoration: underline;">3</span><span>800 fema~  </span><span style="text-decoration: underline;">2</span><span>007
## </span><span style="color: #555555;"> 3</span><span> Adelie  Torgersen        40.3       18              195      </span><span style="text-decoration: underline;">3</span><span>250 fema~  </span><span style="text-decoration: underline;">2</span><span>007
## </span><span style="color: #555555;"> 4</span><span> Adelie  Torgersen        36.7       19.3            193      </span><span style="text-decoration: underline;">3</span><span>450 fema~  </span><span style="text-decoration: underline;">2</span><span>007
## </span><span style="color: #555555;"> 5</span><span> Adelie  Torgersen        39.3       20.6            190      </span><span style="text-decoration: underline;">3</span><span>650 male   </span><span style="text-decoration: underline;">2</span><span>007
## </span><span style="color: #555555;"> 6</span><span> Adelie  Torgersen        38.9       17.8            181      </span><span style="text-decoration: underline;">3</span><span>625 fema~  </span><span style="text-decoration: underline;">2</span><span>007
## </span><span style="color: #555555;"> 7</span><span> Adelie  Torgersen        39.2       19.6            195      </span><span style="text-decoration: underline;">4</span><span>675 male   </span><span style="text-decoration: underline;">2</span><span>007
## </span><span style="color: #555555;"> 8</span><span> Adelie  Torgersen        41.1       17.6            182      </span><span style="text-decoration: underline;">3</span><span>200 fema~  </span><span style="text-decoration: underline;">2</span><span>007
## </span><span style="color: #555555;"> 9</span><span> Adelie  Torgersen        38.6       21.2            191      </span><span style="text-decoration: underline;">3</span><span>800 male   </span><span style="text-decoration: underline;">2</span><span>007
## </span><span style="color: #555555;">10</span><span> Adelie  Torgersen        34.6       21.1            198      </span><span style="text-decoration: underline;">4</span><span>400 male   </span><span style="text-decoration: underline;">2</span><span>007
## </span><span style="color: #555555;"># ... with 323 more rows</span><span>
</span></code></pre>
</div>
<div id="subsetting-the-data" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Subsetting the data<a class="anchor" aria-label="anchor" href="#subsetting-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>This data set contains penguins from three species across three islands:</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">island</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code>## <span style="color: #555555;"># A tibble: 5 x 2</span><span>
##   species   island   
##   </span><span style="color: #555555;font-style: italic;">&lt;fct&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;fct&gt;</span><span>    
## </span><span style="color: #555555;">1</span><span> Adelie    Torgersen
## </span><span style="color: #555555;">2</span><span> Adelie    Biscoe   
## </span><span style="color: #555555;">3</span><span> Adelie    Dream    
## </span><span style="color: #555555;">4</span><span> Gentoo    Biscoe   
## </span><span style="color: #555555;">5</span><span> Chinstrap Dream
</span></code></pre>
<p>For the following example, let us focus only on the penguins of species <em>Adelie</em> from the island
<em>Biscoe</em>. We can obtain this subset of the <code>penguins</code> data using the following code:</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">adeliebiscoe</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Adelie"</span>, <span class="va">island</span> <span class="op">==</span> <span class="st">"Biscoe"</span><span class="op">)</span></code></pre></div>
<p><em>(Note that in the code above, we are using two equal signs since we are making a comparison and
not setting values).</em></p>
</div>
<div id="visual-check-for-linear-relationship" class="section level3" number="3.3.3">
<h3>
<span class="header-section-number">3.3.3</span> Visual check for linear relationship<a class="anchor" aria-label="anchor" href="#visual-check-for-linear-relationship"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose we are interested in fitting a model using body mass as the response and bill length, bill
depth, and flipper length as the predictors. Before building the model, we should verify that there
is a linear relationship between the response and the individual predictors.</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">adeliebiscoe</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_length</span>, y<span class="op">=</span><span class="va">body_mass</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03_files/figure-html/unnamed-chunk-8-1.svg" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">adeliebiscoe</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_depth</span>, y<span class="op">=</span><span class="va">body_mass</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03_files/figure-html/unnamed-chunk-9-1.svg" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">adeliebiscoe</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length</span>, y<span class="op">=</span><span class="va">body_mass</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03_files/figure-html/unnamed-chunk-10-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>The plots look okay. Let's go ahead and fit the model.</p>
</div>
<div id="fit-the-model" class="section level3" number="3.3.4">
<h3>
<span class="header-section-number">3.3.4</span> Fit the model<a class="anchor" aria-label="anchor" href="#fit-the-model"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ad_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">body_mass</span> <span class="op">~</span> <span class="va">bill_length</span> <span class="op">+</span> <span class="va">bill_depth</span> <span class="op">+</span> <span class="va">flipper_length</span>, data<span class="op">=</span><span class="va">adeliebiscoe</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ad_lm</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = body_mass ~ bill_length + bill_depth + flipper_length, 
##     data = adeliebiscoe)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -836.50 -186.29   19.01  183.14  486.90 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -6122.000   1341.697  -4.563 4.71e-05 ***
## bill_length       70.743     21.445   3.299 0.002046 ** 
## bill_depth       165.196     43.802   3.771 0.000526 ***
## flipper_length    21.397      7.262   2.947 0.005336 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 298.8 on 40 degrees of freedom
## Multiple R-squared:  0.6508, Adjusted R-squared:  0.6246 
## F-statistic: 24.85 on 3 and 40 DF,  p-value: 3.048e-09</code></pre>
<p>From the above output, the equation of our fitted line is:</p>
<p><span class="math display">\[\widehat{y}_{i} \,=\, -6122 \,+\, 70.743x_{1,\,i} \,+\, 165.196x_{2,\,i} + 21.397x_{3,\,i}\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(\widehat{y}_{i}\)</span> is the predicted body mass</li>
<li>
<span class="math inline">\(x_{1,\,i}\)</span> is the bill length</li>
<li>
<span class="math inline">\(x_{2,\,i}\)</span> is the bill depth</li>
<li>
<span class="math inline">\(x_{3,\,i}\)</span> is the flipper length</li>
</ul>
</div>
<div id="fitting-a-model-without-an-intercept" class="section level3" number="3.3.5">
<h3>
<span class="header-section-number">3.3.5</span> Fitting a model without an intercept<a class="anchor" aria-label="anchor" href="#fitting-a-model-without-an-intercept"><i class="fas fa-link"></i></a>
</h3>
<p>By default, linear models are fitted with an intercept. We can fit a linear model without an
intercept by adding a <code>+ 0</code> or a <code>- 1</code> in the formula specification (see the Details section of
<code><a href="https://rdrr.io/r/stats/lm.html">?lm</a></code>). To make the hypothesis tests that we will do in the next section a bit more interesting,
let us remove the intercept from the model that we just fit and overwrite it.</p>
<p>As shown in Lab 1, we can do this by fitting a brand new model using <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>:</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ad_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">body_mass</span> <span class="op">~</span> <span class="va">bill_length</span> <span class="op">+</span> <span class="va">bill_depth</span> <span class="op">+</span> <span class="va">flipper_length</span> <span class="op">-</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">adeliebiscoe</span><span class="op">)</span></code></pre></div>
<p>or by using <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code>:</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ad_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">ad_lm</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>Recall that the above line of code means that (the new) <code>ad_lm</code> is constructed by taking the
existing <code>ad_lm</code> and updating its formula. The response variable remains the same (represented by
the dot on the left of the tilde), the predictors remain the same (represented by the dot on the
right of the tilde) and a <code>- 1</code> denotes that we do not want an intercept.</p>
<p>Let's take a look at our new model.</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ad_lm</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = body_mass ~ bill_length + bill_depth + flipper_length - 
##     1, data = adeliebiscoe)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -737.69 -296.78   41.82  236.37  769.39 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)  
## bill_length      58.741     25.922   2.266   0.0288 *
## bill_depth      125.323     52.276   2.397   0.0212 *
## flipper_length   -4.635      5.471  -0.847   0.4018  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 363.9 on 41 degrees of freedom
## Multiple R-squared:  0.9912, Adjusted R-squared:  0.9905 
## F-statistic:  1536 on 3 and 41 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Interestingly, by removing the intercept from the model, our adjusted R-squared value went from
0.6246 to 0.9905 👀.</p>
</div>
<div id="anova-with-multiple-linear-regression-models" class="section level3" number="3.3.6">
<h3>
<span class="header-section-number">3.3.6</span> ANOVA with multiple linear regression models<a class="anchor" aria-label="anchor" href="#anova-with-multiple-linear-regression-models"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">ad_lm</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: body_mass
##                Df    Sum Sq   Mean Sq   F value  Pr(&gt;F)    
## bill_length     1 609528281 609528281 4601.6610 &lt; 2e-16 ***
## bill_depth      1    683988    683988    5.1638 0.02837 *  
## flipper_length  1     95065     95065    0.7177 0.40182    
## Residuals      41   5430791    132458                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>For multiple linear regression, the output resulting from passing our linear model to <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> is
slightly different from what we saw with simple linear regression. In simple linear regression,
wrapping our linear model with <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> produced the "classic" <span class="math inline">\(F\)</span>-table: the sum of squares for
the first row was the SSR, the sum of squares for the second row was the SSE, and there was a single
<span class="math inline">\(F\)</span>-value and corresponding <span class="math inline">\(p\)</span>-value.</p>
<p>In the above output, we now have three <span class="math inline">\(F\)</span>-values and three corresponding <span class="math inline">\(p\)</span>-values! However, the
interpretation here is slightly different. The sum of squares column represents the <strong>sequential</strong>
increase in SSR (or decrease in SSE) by adding the variable to the model that came before it. As
such:</p>
<ul>
<li>The sum of squares on the <code>bill_length</code> row is the increase in SSR (or decrease in SSE) by
including only <code>bill_length</code> in the model (because our base model has no intercept)</li>
<li>The sum of squares on the <code>bill_depth</code> row is the increase in SSR (or decrease in SSE) by
including <code>bill_depth</code> in the model that <strong>already</strong> includes <code>bill_length</code>
</li>
<li>The sum of squares on the <code>flipper_length</code> row is the increase in SSR (or decrease in SSE) by
including <code>flipper_length</code> to the model that <strong>already</strong> includes <code>bill_length</code> and <code>bill_depth</code>
</li>
<li>The sum of squares on the <code>Residual</code> row is the SSE of the model that includes <strong>all</strong> of
<code>bill_length</code>, <code>bill_depth</code>, and <code>flipper_length</code>
</li>
</ul>
<p>Using only the output above, if we wish to perform a hypothesis test to check whether a subset of
the parameters are different from zero, we need to do some extra math. But since we are using R,
let's not do math! We can perform the partial <span class="math inline">\(F\)</span>-tests that we are interested in by constructing
reduced models (and this is where the <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> function becomes extremely handy).</p>
</div>
<div id="at-least-one-parameter-non-zero" class="section level3" number="3.3.7">
<h3>
<span class="header-section-number">3.3.7</span> At least one parameter non-zero<a class="anchor" aria-label="anchor" href="#at-least-one-parameter-non-zero"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose we are interested in testing the hypotheses:</p>
<p><span class="math display">\[H_{0}: \beta_{1} \,=\, \beta_{2} \,=\, \beta_{3} \,=\, 0, \quad
H_{A}: \text{At least one non-zero}\]</span></p>
<p>The reduced model is the intercept-only model that passes through the origin.</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ad_lm_origin_only</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">ad_lm</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>The full model is the model that has all the predictors (<code>ad_lm</code>).</p>
<p>To test the above hypotheses, we pass our reduced and full models to <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>:</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">ad_lm_origin_only</span>, <span class="va">ad_lm</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: body_mass ~ 1 - 1
## Model 2: body_mass ~ bill_length + bill_depth + flipper_length - 1
##   Res.Df       RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1     44 615738125                                  
## 2     41   5430791  3 610307334 1535.8 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>The produces a <span class="math inline">\(F\)</span>-value of 1535.8 with numerator degrees of freedom, 3, and denominator degrees of
freedom, 41. But we don't need to use these values since a <span class="math inline">\(p\)</span>-value is also given. Using a
significance level of <span class="math inline">\(\alpha = 0.05\)</span>, since the <span class="math inline">\(p\)</span>-value is less than 0.05, we reject the null
hypothesis and conclude that at least one of the parameters is non-zero and as such, we should not
consider a constant <span class="math inline">\((Y \,=\, 0)\)</span> model. It is important to note that the result of this hypothesis
test tells us that at least one parameter is non-zero, but it doesn't tell us <strong>which</strong>.</p>
<p>A hypothesis test that has a null hypothesis where all parameters are equal to zero is often known
as a test for model usefulness. If we fail to reject this null hypothesis, it suggests that the
current model is not a substantial improvement over a constant <span class="math inline">\((Y \,=\, c)\)</span> model.</p>
</div>
<div id="two-parameters-non-zero" class="section level3" number="3.3.8">
<h3>
<span class="header-section-number">3.3.8</span> Two parameters non-zero<a class="anchor" aria-label="anchor" href="#two-parameters-non-zero"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose we are interested in testing the hypotheses:</p>
<p><span class="math display">\[H_{0}: \beta_{2} \,=\, \beta_{3} \,=\, 0, \quad H_{A}: \text{At least one non-zero}\]</span></p>
<p>The reduced model is the model that contains only <code>bill_length</code>. We can construct this model using
<code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> either by specifying the variables we want:</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Don't forget the no-intercept term!!</span>
<span class="va">ad_lm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">ad_lm</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">bill_length</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>or the variables we do not want</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ad_lm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">ad_lm</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">bill_depth</span> <span class="op">-</span> <span class="va">flipper_length</span><span class="op">)</span></code></pre></div>
<p>To test the above hypotheses, we pass our reduced and full models to <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>:</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">ad_lm1</span>, <span class="va">ad_lm</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: body_mass ~ bill_length - 1
## Model 2: body_mass ~ bill_length + bill_depth + flipper_length - 1
##   Res.Df     RSS Df Sum of Sq      F  Pr(&gt;F)  
## 1     43 6209844                              
## 2     41 5430791  2    779053 2.9407 0.06405 .
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>This produces a <span class="math inline">\(F\)</span>-value of 2.9407 with numerator degrees of freedom, 2, and denominator degrees
of freedom, 41. Using the usual significance level of <span class="math inline">\(\alpha = 0.05\)</span>, since the <span class="math inline">\(p\)</span>-value is
greater than 0.05, we fail to reject the null hypothesis and conclude that there is insufficient
evidence to support the claim that at least one of <span class="math inline">\(\beta_{2}\)</span> or <span class="math inline">\(\beta_{3}\)</span> are non-zero.</p>
</div>
<div id="one-parameter-non-zero" class="section level3" number="3.3.9">
<h3>
<span class="header-section-number">3.3.9</span> One parameter non-zero<a class="anchor" aria-label="anchor" href="#one-parameter-non-zero"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose we are interested in testing the hypotheses:</p>
<p><span class="math display">\[H_{0}: \beta_{3} \,=\, 0, \quad H_{A}: \beta_{3} \,\neq\, 0\]</span></p>
<p>This hypothesis can be carried out by performing a <span class="math inline">\(F\)</span>-test or a <span class="math inline">\(t\)</span>-test (the <span class="math inline">\(t\)</span>-test is much
simpler). If we want to perform a <span class="math inline">\(F\)</span>-test, we take the usual steps of first constructing the
reduced model. The reduced model is the model that contains <code>bill_length</code> and <code>bill_depth</code>. We can
construct this model by using <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> and removing <code>flipper_length</code>.</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ad_lm12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">ad_lm</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">flipper_length</span><span class="op">)</span></code></pre></div>
<p>To test the above hypotheses, we pass our reduced and full models to <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>:</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">ad_lm12</span>, <span class="va">ad_lm</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: body_mass ~ bill_length + bill_depth - 1
## Model 2: body_mass ~ bill_length + bill_depth + flipper_length - 1
##   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)
## 1     42 5525856                           
## 2     41 5430791  1     95065 0.7177 0.4018</code></pre>
<p>This produces a <span class="math inline">\(F\)</span>-value of 0.7177 with numerator degrees of freedom, 1, and denominator degrees
of freedom, 41. Using the usual significance level of <span class="math inline">\(\alpha = 0.05\)</span>, since the <span class="math inline">\(p\)</span>-value is
greater than 0.05, we fail to reject the null hypothesis and conclude that there is insufficient
evidence to support the claim that <span class="math inline">\(\beta_{3}\)</span> is different from zero.</p>
<p>In testing a single parameter non-zero, we could have done a <span class="math inline">\(t\)</span>-test, whose corresponding <span class="math inline">\(p\)</span>-value
could have been read off the coefficient summary table.</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">ad_lm</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code>## <span style="color: #555555;"># A tibble: 3 x 5</span><span>
##   term           estimate std.error statistic p.value
##   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>             </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
## </span><span style="color: #555555;">1</span><span> bill_length       58.7      25.9      2.27   0.028</span><span style="text-decoration: underline;">8</span><span>
## </span><span style="color: #555555;">2</span><span> bill_depth       125.       52.3      2.40   0.021</span><span style="text-decoration: underline;">2</span><span>
## </span><span style="color: #555555;">3</span><span> flipper_length    -</span><span style="color: #BB0000;">4.64</span><span>      5.47    -</span><span style="color: #BB0000;">0.847</span><span>  0.402
</span></code></pre>
<p>The corresponding <span class="math inline">\(p\)</span>-value for this <span class="math inline">\(t\)</span>-test is 0.402. Since this <span class="math inline">\(p\)</span>-value is greater than 0.05,
we fail to reject the null hypothesis once again.</p>
</div>
<div id="caution" class="section level3" number="3.3.10">
<h3>
<span class="header-section-number">3.3.10</span> Caution ❗<a class="anchor" aria-label="anchor" href="#caution"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose we had output that looked like:</p>
<pre class="fansi fansi-output"><code>## <span style="color: #555555;"># A tibble: 3 x 5</span><span>
##   term  estimate std.error statistic p.value
##   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>    </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>       </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
## </span><span style="color: #555555;">1</span><span> var1  ...      ...       ...        0.000</span><span style="text-decoration: underline;">1</span><span>
## </span><span style="color: #555555;">2</span><span> var2  ...      ...       ...        0.497 
## </span><span style="color: #555555;">3</span><span> var3  ...      ...       ...        0.885
</span></code></pre>
<p>It is <strong>not</strong> correct to say:</p>
<blockquote>
<p>The <span class="math inline">\(p\)</span>-values for the tests of <code>var2</code> different from zero and <code>var3</code> different from zero are
0.4971 and 0.8846, respectively. Since both <span class="math inline">\(p\)</span>-values are larger than 0.05, we fail to reject the
null hypothesis in both tests. Therefore we can simultaneously remove <code>var2</code> and <code>var3</code> from our
model.</p>
</blockquote>
<p>The <span class="math inline">\(p\)</span>-value of 0.497 corresponds to testing <code>var2</code> different from zero, assuming <code>var1</code> and <code>var3</code>
are included in model. Similarly, the <span class="math inline">\(p\)</span>-value of 0.885 corresponds to testing <code>var3</code> different
from zero, assuming that <code>var1</code> and <code>var2</code> are included in the model. Therefore the proper procedure
using <span class="math inline">\(t\)</span>-tests would be to test for a single parameter being non-zero, remove the variable from the
model (assuming we failed to reject the null hypothesis), refit a new model without this variable,
and then perform a second <span class="math inline">\(t\)</span>-test.</p>
</div>
</div>
<div id="multiple-linear-regression-working-with-matrices-in-r" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Multiple linear regression — working with matrices in R<a class="anchor" aria-label="anchor" href="#multiple-linear-regression-working-with-matrices-in-r"><i class="fas fa-link"></i></a>
</h2>
<div id="creating-a-matrix-in-r" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Creating a matrix in R<a class="anchor" aria-label="anchor" href="#creating-a-matrix-in-r"><i class="fas fa-link"></i></a>
</h3>
<p>To begin, I recommend checking out the related documentation by calling <code><a href="https://rdrr.io/r/base/matrix.html">?matrix</a></code>. The main
arguments of interest are:</p>
<ul>
<li>
<code>data</code>: the data for your matrix</li>
<li>
<code>nrow</code>: the number of rows your matrix should have</li>
<li>
<code>ncol</code>: the number of columns your matrix should have</li>
<li>
<code>byrow</code>: when set to <code>TRUE</code>, the supplied data are filled in horizontally (by row), otherwise the
data are filled in vertically (by column). By default data is filled in vertically.</li>
</ul>
<p>To illustrate how the data gets filled in depending on the value of <code>byrow</code>:</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nums</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span>

<span class="va">mat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">nums</span>, nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="va">mat1</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nums2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">2</span>, <span class="fl">7</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>
<span class="va">mat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">nums2</span>, nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">3</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">mat2</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    9    2
## [3,]    7    3    6</code></pre>
</div>
<div id="matrix-operations" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> Matrix operations<a class="anchor" aria-label="anchor" href="#matrix-operations"><i class="fas fa-link"></i></a>
</h3>
<div id="matrix-transpose" class="section level4" number="3.4.2.1">
<h4>
<span class="header-section-number">3.4.2.1</span> Matrix transpose<a class="anchor" aria-label="anchor" href="#matrix-transpose"><i class="fas fa-link"></i></a>
</h4>
<p>To obtain the transpose of a matrix, use <code><a href="https://rdrr.io/r/base/t.html">t()</a></code>:</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat1</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6
## [3,]    7    8    9</code></pre>
</div>
<div id="matrix-inverse" class="section level4" number="3.4.2.2">
<h4>
<span class="header-section-number">3.4.2.2</span> Matrix inverse<a class="anchor" aria-label="anchor" href="#matrix-inverse"><i class="fas fa-link"></i></a>
</h4>
<p>To obtain the inverse of a matrix, use <code><a href="https://rdrr.io/r/base/solve.html">solve()</a></code>:</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat2</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    9    2
## [3,]    7    3    6</code></pre>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">mat2</span><span class="op">)</span></code></pre></div>
<pre><code>##        [,1]   [,2]   [,3]
## [1,] -0.384  0.024  0.184
## [2,]  0.080  0.120 -0.080
## [3,]  0.408 -0.088 -0.008</code></pre>
<p><code><a href="https://rdrr.io/r/base/solve.html">solve()</a></code> will return an error if your matrix is not invertible.</p>
</div>
<div id="matrix-multiplication" class="section level4" number="3.4.2.3">
<h4>
<span class="header-section-number">3.4.2.3</span> Matrix multiplication<a class="anchor" aria-label="anchor" href="#matrix-multiplication"><i class="fas fa-link"></i></a>
</h4>
<p>To multiply two matrices together, use <code><a href="https://rdrr.io/r/base/matmult.html">%*%</a></code>:</p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat1</span> <span class="op">%*%</span> <span class="va">mat2</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   66   59   53
## [2,]   78   73   64
## [3,]   90   87   75</code></pre>
<p>You <strong>cannot</strong> use the usual multiplication operator because that will perform element-wise
multiplication, rather than matrix multiplication:</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat1</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat2</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    9    2
## [3,]    7    3    6</code></pre>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat1</span> <span class="op">*</span> <span class="va">mat2</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    8   21
## [2,]    8   45   16
## [3,]   21   18   54</code></pre>
</div>
</div>
<div id="example-question-k-page-174-selected-parts" class="section level3" number="3.4.3">
<h3>
<span class="header-section-number">3.4.3</span> Example: Question K, page 174 (selected parts)<a class="anchor" aria-label="anchor" href="#example-question-k-page-174-selected-parts"><i class="fas fa-link"></i></a>
</h3>
<p>From the given data, we can start by constructing our matrices.</p>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7.2</span>, <span class="fl">8.1</span>, <span class="fl">9.8</span>, <span class="fl">12.3</span>, <span class="fl">12.9</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">5</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">Y</span></code></pre></div>
<pre><code>##      [,1]
## [1,]  7.2
## [2,]  8.1
## [3,]  9.8
## [4,] 12.3
## [5,] 12.9</code></pre>
<p>Don't forget the column of ones in the design matrix that corresponds to the intercept! Let's also
supply some column names to the design matrix to keep track of the columns and so that our
resulting coefficient estimates will have names.</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,
  nrow<span class="op">=</span><span class="fl">5</span>, ncol<span class="op">=</span><span class="fl">3</span>,
  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"X1"</span>, <span class="st">"X2"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">X</span></code></pre></div>
<pre><code>##      Intercept X1 X2
## [1,]         1 -1 -1
## [2,]         1 -1  0
## [3,]         1  0  0
## [4,]         1  1  0
## [5,]         1  1  1</code></pre>
<p>In supplying names to a matrix during its construction, a list of length 2 must be supplied
specifying the row and column names respectively. Since I don't need any rownames I supply <code>NULL</code> to
the first element of the list. Note that this list has length 2: <code>NULL</code> is one element, and
<code><a href="https://rdrr.io/r/base/c.html">c("Intercept", "X1", "X2")</a></code> is another element. An alternative is to build a matrix with no names
and set the names afterward using:</p>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"row1"</span>, <span class="st">"row2"</span>, <span class="st">"etc."</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"col1"</span>, <span class="st">"col2"</span>, <span class="st">"etc."</span><span class="op">)</span></code></pre></div>
<div id="obtain-the-coefficient-estimates" class="section level4" number="3.4.3.1">
<h4>
<span class="header-section-number">3.4.3.1</span> Obtain the coefficient estimates<a class="anchor" aria-label="anchor" href="#obtain-the-coefficient-estimates"><i class="fas fa-link"></i></a>
</h4>
<p>We can obtain the coefficient estimates using the equation:</p>
<p><span class="math display">\[\widehat{\beta} \,=\, (X^{T}X)^{-1}\,X^{T}\,Y\]</span></p>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">betahat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">Y</span>
<span class="va">betahat</span></code></pre></div>
<pre><code>##            [,1]
## Intercept 10.06
## X1         2.10
## X2         0.75</code></pre>
<p>The equation of the fitted line is:</p>
<p><span class="math display">\[\widehat{y}_{i} \,=\, 10.06 \,+\, 2.10x_{1,\,i} \,+\, 0.75x_{2,\,i}\]</span></p>
</div>
<div id="compute-the-following-regression-sum-of-squares" class="section level4" number="3.4.3.2">
<h4>
<span class="header-section-number">3.4.3.2</span> Compute the following regression sum of squares<a class="anchor" aria-label="anchor" href="#compute-the-following-regression-sum-of-squares"><i class="fas fa-link"></i></a>
</h4>
<div id="i" class="section level5" number="3.4.3.2.1">
<h5>
<span class="header-section-number">3.4.3.2.1</span> (i)<a class="anchor" aria-label="anchor" href="#i"><i class="fas fa-link"></i></a>
</h5>
<p><span class="math display">\[SS(\widehat{\beta}_{0},\, \widehat{\beta}_{1},\, \widehat{\beta}_{2}) \,=\, \widehat{\beta}^{T}\,X^{T}\,Y\]</span></p>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">betahat</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">Y</span></code></pre></div>
<pre><code>##         [,1]
## [1,] 531.083</code></pre>
</div>
<div id="ii" class="section level5" number="3.4.3.2.2">
<h5>
<span class="header-section-number">3.4.3.2.2</span> (ii)<a class="anchor" aria-label="anchor" href="#ii"><i class="fas fa-link"></i></a>
</h5>
<p><span class="math display">\[SS(\widehat{\beta}_{1},\, \widehat{\beta}_{2} \,|\, \widehat{\beta}_{0}) \,=\, \widehat{\beta}^{T}\,X^{T}\,Y \,-\, \frac{1}{n}Y^{T}\,Y\]</span></p>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">betahat</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">Y</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">Y</span><span class="op">)</span></code></pre></div>
<pre><code>##         [,1]
## [1,] 424.845</code></pre>
</div>
<div id="iii" class="section level5" number="3.4.3.2.3">
<h5>
<span class="header-section-number">3.4.3.2.3</span> (iii)<a class="anchor" aria-label="anchor" href="#iii"><i class="fas fa-link"></i></a>
</h5>
<p><span class="math display">\[SS(\widehat{\beta}_{2} \,|\, \widehat{\beta}_{1},\, \widehat{\beta}_{0}) \,=\, SS(\widehat{\beta}_{0},\, \widehat{\beta}_{1},\, \widehat{\beta}_{2})
\,-\, SS(\widehat{\beta}_{0},\,\widehat{\beta}_{1})\]</span></p>
<p>We already have the first term. The second term is obtained by fitting a model without the <span class="math inline">\(X_{2}\)</span>
variable and computing</p>
<p><span class="math display">\[SS(\widehat{\beta}_{0},\, \widehat{\beta}_{1}) \,=\, \widehat{\beta}^{T}\,X^{T}\,Y\]</span></p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X_reduced</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span>, <span class="op">-</span><span class="fl">3</span><span class="op">]</span>
<span class="va">X_reduced</span></code></pre></div>
<pre><code>##      Intercept X1
## [1,]         1 -1
## [2,]         1 -1
## [3,]         1  0
## [4,]         1  1
## [5,]         1  1</code></pre>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">betahat_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X_reduced</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">X_reduced</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X_reduced</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">Y</span>
<span class="va">betahat_reduced</span></code></pre></div>
<pre><code>##             [,1]
## Intercept 10.060
## X1         2.475</code></pre>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">betahat_reduced</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X_reduced</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">Y</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 530.5205</code></pre>
<p>Therefore the quantity</p>
<p><span class="math display">\[SS(\widehat{\beta}_{2} \,|\, \widehat{\beta}_{1},\, \widehat{\beta}_{0}) \,=\, SS(\widehat{\beta}_{0},\, \widehat{\beta}_{1},\,\widehat{\beta}_{2})
\,-\, SS(\widehat{\beta}_{0},\,\widehat{\beta}_{1})$\]</span></p>
<p>can be computed as:</p>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">betahat</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">Y</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">betahat_reduced</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X_reduced</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">Y</span><span class="op">)</span></code></pre></div>
<pre><code>##        [,1]
## [1,] 0.5625</code></pre>
</div>
</div>
<div id="obtain-the-residual-sum-of-squares" class="section level4" number="3.4.3.3">
<h4>
<span class="header-section-number">3.4.3.3</span> Obtain the residual sum of squares<a class="anchor" aria-label="anchor" href="#obtain-the-residual-sum-of-squares"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[SSE \,=\, Y^{T}\,Y \,-\, \widehat{\beta}^{T}\,X^{T}\,Y\]</span></p>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SSE</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">Y</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">betahat</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">Y</span><span class="op">)</span>
<span class="va">SSE</span></code></pre></div>
<pre><code>##       [,1]
## [1,] 0.107</code></pre>
</div>
<div id="obtain-an-estimate-for-error-term-variance" class="section level4" number="3.4.3.4">
<h4>
<span class="header-section-number">3.4.3.4</span> Obtain an estimate for error term variance<a class="anchor" aria-label="anchor" href="#obtain-an-estimate-for-error-term-variance"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[\widehat{\sigma}^{2} \,=\, S^{2} \,=\, MSE \,=\, \frac{SSE}{\text{df}_{SSE}}\]</span></p>
<p>The degrees of freedom of the SSE is <span class="math inline">\(n - p - 1\)</span> where <span class="math inline">\(n\)</span> is the number of observations, and <span class="math inline">\(p\)</span>
is the number of non-intercept parameters estimated. Here, <span class="math inline">\(n = 5\)</span> and <span class="math inline">\(p = 2\)</span>. So</p>
<p><span class="math display">\[\text{df}_{SSE} \,=\, n - p - 1 \,=\, 5 - 2 - 1 \,=\, 2\]</span></p>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MSE</span> <span class="op">&lt;-</span> <span class="va">SSE</span> <span class="op">/</span> <span class="fl">2</span>
<span class="va">MSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">MSE</span><span class="op">)</span>
<span class="va">MSE</span></code></pre></div>
<pre><code>## [1] 0.0535</code></pre>
<p>Note: We need to wrap <code>MSE</code> in <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code> to coerce it to a scalar for future calculations.
Otherwise, in R, this value is still treated as a 1x1 matrix and matrix operations may fail due
to incompatible matrix dimensions.</p>
</div>
<div id="obtain-the-variance-covariance-matrix-of-the-coefficient-estimates" class="section level4" number="3.4.3.5">
<h4>
<span class="header-section-number">3.4.3.5</span> Obtain the variance-covariance matrix of the coefficient estimates<a class="anchor" aria-label="anchor" href="#obtain-the-variance-covariance-matrix-of-the-coefficient-estimates"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[\textbf{Var}(\widehat{\beta}) \,=\, \widehat{\sigma}^{2}(X^{T}\,X)^{-1}\]</span></p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vcov_betahat</span> <span class="op">&lt;-</span> <span class="va">MSE</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">X</span><span class="op">)</span>
<span class="va">vcov_betahat</span></code></pre></div>
<pre><code>##           Intercept       X1       X2
## Intercept    0.0107  0.00000  0.00000
## X1           0.0000  0.02675 -0.02675
## X2           0.0000 -0.02675  0.05350</code></pre>
<p>The variances are along the diagonal of the matrix. The covariances are the off-diagonal terms. If
we wanted the standard errors for all coefficient estimates we would need to take the square root
of all the diagonal terms. We can do this by first extracting the diagonal elements by wrapping
<code>vcov_betahat</code> with <code><a href="https://rdrr.io/r/base/diag.html">diag()</a></code>, and then wrapping it in <code><a href="https://rdrr.io/r/base/MathFun.html">sqrt()</a></code>.</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">se_betahat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">vcov_betahat</span><span class="op">)</span><span class="op">)</span>
<span class="va">se_betahat</span></code></pre></div>
<pre><code>## Intercept        X1        X2 
## 0.1034408 0.1635543 0.2313007</code></pre>
</div>
<div id="predict-the-mean-response-value-at-a-given-point" class="section level4" number="3.4.3.6">
<h4>
<span class="header-section-number">3.4.3.6</span> Predict the mean response value at a given point<a class="anchor" aria-label="anchor" href="#predict-the-mean-response-value-at-a-given-point"><i class="fas fa-link"></i></a>
</h4>
<p>Find <span class="math inline">\(\widehat{Y}_{0}\)</span> at point <span class="math inline">\((X_{1,\,0},\, X_{2,\,0}) \,=\, (0.5, 0)\)</span>.</p>
<p><span class="math display">\[\widehat{y}_{0} \,=\, x_{0}^{T}\widehat{\beta} \,=\, \begin{bmatrix}1 &amp;0.5 &amp;0\end{bmatrix}
\begin{bmatrix}10.06\\ 2.10\\ 0.75\end{bmatrix}\]</span></p>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">x0</span></code></pre></div>
<pre><code>##      [,1]
## [1,]  1.0
## [2,]  0.5
## [3,]  0.0</code></pre>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">betahat</span></code></pre></div>
<pre><code>##       [,1]
## [1,] 11.11</code></pre>
</div>
<div id="obtain-the-standard-error-of-the-mean-response-at-the-given-point" class="section level4" number="3.4.3.7">
<h4>
<span class="header-section-number">3.4.3.7</span> Obtain the standard error of the mean response at the given point<a class="anchor" aria-label="anchor" href="#obtain-the-standard-error-of-the-mean-response-at-the-given-point"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[\textbf{se}(\widehat{Y}_{0}) \,=\, \sqrt{\widehat{\sigma}^{2}x_{0}^{T}(X^{T}\,X)^{-1}x_{0}}\]</span></p>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">MSE</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">x0</span><span class="op">)</span></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.1318617</code></pre>
</div>
<div id="weighted-least-squares" class="section level4" number="3.4.3.8">
<h4>
<span class="header-section-number">3.4.3.8</span> Weighted least squares<a class="anchor" aria-label="anchor" href="#weighted-least-squares"><i class="fas fa-link"></i></a>
</h4>
<p>From the information given in the question, the variance of the error term is now</p>
<p><span class="math display">\[\textbf{Var}(\varepsilon) \,=\, \sigma^{2}V\]</span></p>
<p>where</p>
<p><span class="math display">\[V \,=\, 
\begin{bmatrix}
1 &amp;0 &amp;0 &amp;0 &amp;0\\
0 &amp;1 &amp;0 &amp;0 &amp;0\\
0 &amp;0 &amp;1/4 &amp;0 &amp;0\\
0 &amp;0 &amp;0 &amp;1 &amp;0\\
0 &amp;0 &amp;0 &amp;0 &amp;1
\end{bmatrix}\]</span></p>
<p>and <span class="math inline">\(V^{-1}\)</span> is the "weight matrix".</p>
<p>The new estimates are computed using:</p>
<p><span class="math display">\[\widehat{\beta} \,=\, (X^{T}\,V^{-1}\,X)^{-1}\,X^{T}\,V^{-1}\,Y\]</span></p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">V</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0 0.00    0    0
## [2,]    0    1 0.00    0    0
## [3,]    0    0 0.25    0    0
## [4,]    0    0 0.00    1    0
## [5,]    0    0 0.00    0    1</code></pre>
<p>Recall that the inverse of a diagonal matrix is still a diagonal matrix where all the diagonal terms
have been reciprocated.</p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">V_inv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span>
<span class="va">V_inv</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    0    0
## [2,]    0    1    0    0    0
## [3,]    0    0    4    0    0
## [4,]    0    0    0    1    0
## [5,]    0    0    0    0    1</code></pre>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">betahat_weighted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">V_inv</span> <span class="op">%*%</span> <span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">V_inv</span> <span class="op">%*%</span> <span class="va">Y</span>
<span class="va">betahat_weighted</span></code></pre></div>
<pre><code>##             [,1]
## Intercept 9.9625
## X1        2.1000
## X2        0.7500</code></pre>
</div>
</div>
</div>
<div id="simple-linear-regression-simultaneous-confidence-regions" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Simple linear regression — simultaneous confidence regions<a class="anchor" aria-label="anchor" href="#simple-linear-regression-simultaneous-confidence-regions"><i class="fas fa-link"></i></a>
</h2>
<p>Let us return to the <code>rock</code> data set and consider the simple linear regression model of <code>area</code> as
the response variable and <code>peri</code> as the predictor.</p>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">rock</span><span class="op">)</span>

<span class="va">slr_rock</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">area</span> <span class="op">~</span> <span class="va">peri</span>, data<span class="op">=</span><span class="va">rock</span><span class="op">)</span></code></pre></div>
<p>Suppose we are interested in constructing a 90% confidence region for <span class="math inline">\((\beta_{0}, \beta_{1})\)</span> with
individual 95% confidence intervals. We can start by obtaining the path of this ellipse by passing
our linear model to <code><a href="https://rdrr.io/pkg/ellipse/man/ellipse.html">ellipse()</a></code>. The default confidence level for the ellipse is 95% so we need to
make a slight adjustment to the value of the <code>level</code> parameter. In addition, <code><a href="https://rdrr.io/pkg/ellipse/man/ellipse.html">ellipse()</a></code> returns a
matrix of coordinates for the path of the ellipse. Since we'll be passing the coordinates of the
path of the ellipse to <code>ggplot</code> later, we should also convert it to a data frame.</p>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ellipse_path</span> <span class="op">&lt;-</span> <span class="va">slr_rock</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ellipse/man/ellipse.html">ellipse</a></span><span class="op">(</span>level<span class="op">=</span><span class="fl">0.90</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">ellipse_path</span></code></pre></div>
<pre class="fansi fansi-output"><code>## <span style="color: #555555;"># A tibble: 100 x 2</span><span>
##    `(Intercept)`  peri
##            </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
## </span><span style="color: #555555;"> 1</span><span>         </span><span style="text-decoration: underline;">3</span><span>305.  1.63
## </span><span style="color: #555555;"> 2</span><span>         </span><span style="text-decoration: underline;">3</span><span>239.  1.65
## </span><span style="color: #555555;"> 3</span><span>         </span><span style="text-decoration: underline;">3</span><span>174.  1.67
## </span><span style="color: #555555;"> 4</span><span>         </span><span style="text-decoration: underline;">3</span><span>107.  1.69
## </span><span style="color: #555555;"> 5</span><span>         </span><span style="text-decoration: underline;">3</span><span>041.  1.71
## </span><span style="color: #555555;"> 6</span><span>         </span><span style="text-decoration: underline;">2</span><span>974.  1.73
## </span><span style="color: #555555;"> 7</span><span>         </span><span style="text-decoration: underline;">2</span><span>908.  1.74
## </span><span style="color: #555555;"> 8</span><span>         </span><span style="text-decoration: underline;">2</span><span>842.  1.76
## </span><span style="color: #555555;"> 9</span><span>         </span><span style="text-decoration: underline;">2</span><span>777.  1.78
## </span><span style="color: #555555;">10</span><span>         </span><span style="text-decoration: underline;">2</span><span>714.  1.79
## </span><span style="color: #555555;"># ... with 90 more rows</span><span>
</span></code></pre>
<p>The values under the <code>(Intercept)</code> and <code>peri</code> columns represent the x- and y-values, respectively,
of the path of the ellipse. Note that <code><a href="https://rdrr.io/pkg/ellipse/man/ellipse.html">ellipse()</a></code> is another example of a generic function. When
passing a linear model object (an object of class <code>lm</code>) to <code><a href="https://rdrr.io/pkg/ellipse/man/ellipse.html">ellipse()</a></code>, it calls the more specific
<code><a href="https://rdrr.io/pkg/ellipse/man/ellipse.lm.html">ellipse.lm()</a></code>.</p>
<p>Now that we have the path of the ellipse, we also need to obtain the point
<span class="math inline">\((\widehat{\beta}_{0},\, \widehat{\beta}_{1})\)</span>, and the individual 95% confidence intervals for
<span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span>. We can obtain these by passing our linear model to <code><a href="https://broom.tidymodels.org/reference/tidy.lm.html">tidy.lm()</a></code> and
specifying <code>conf.int=TRUE</code> to obtain both the coefficient table and corresponding 95% confidence
intervals.</p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coef_table</span> <span class="op">&lt;-</span> <span class="va">slr_rock</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>conf.int<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="va">coef_table</span></code></pre></div>
<pre class="fansi fansi-output"><code>## <span style="color: #555555;"># A tibble: 2 x 7</span><span>
##   term        estimate std.error statistic  p.value conf.low conf.high
##   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>          </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>    </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>    </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
## </span><span style="color: #555555;">1</span><span> (Intercept)  </span><span style="text-decoration: underline;">3</span><span>052.     477.         6.40 7.26</span><span style="color: #555555;">e</span><span style="color: #BB0000;">- 8</span><span>  </span><span style="text-decoration: underline;">2</span><span>092.     </span><span style="text-decoration: underline;">4</span><span>012.  
## </span><span style="color: #555555;">2</span><span> peri            1.54     0.157      9.81 7.51</span><span style="color: #555555;">e</span><span style="color: #BB0000;">-13</span><span>     1.23      1.86
</span></code></pre>
<p>Before we can begin plotting, we have to do some data reshaping. Recall that when plotting with
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, we need all of our x-values in one column and all our y-values in another column.</p>
<p>We need a data frame where the estimate of <span class="math inline">\(\beta_{0}\)</span> is in one column and the estimate of
<span class="math inline">\(\beta_{1}\)</span> is in another column.</p>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coef_point</span> <span class="op">&lt;-</span> <span class="va">coef_table</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">term</span>, <span class="va">estimate</span><span class="op">)</span>, names_from<span class="op">=</span><span class="va">term</span>, values_from<span class="op">=</span><span class="va">estimate</span><span class="op">)</span>

<span class="va">coef_point</span></code></pre></div>
<pre class="fansi fansi-output"><code>## <span style="color: #555555;"># A tibble: 1 x 2</span><span>
##   `(Intercept)`  peri
##           </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
## </span><span style="color: #555555;">1</span><span>         </span><span style="text-decoration: underline;">3</span><span>052.  1.54
</span></code></pre>
<p>We need a data frame where the lower and upper bounds of the confidence interval for <span class="math inline">\(\beta_{0}\)</span>
are in a single column.</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="va">coef_table</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"conf"</span><span class="op">)</span><span class="op">)</span>

<span class="va">beta0</span></code></pre></div>
<pre class="fansi fansi-output"><code>## <span style="color: #555555;"># A tibble: 2 x 7</span><span>
##   term        estimate std.error statistic      p.value name      value
##   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>          </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>        </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
## </span><span style="color: #555555;">1</span><span> (Intercept)    </span><span style="text-decoration: underline;">3</span><span>052.      477.      6.40 0.000</span><span style="text-decoration: underline;">000</span><span>072</span><span style="text-decoration: underline;">6</span><span> conf.low  </span><span style="text-decoration: underline;">2</span><span>092.
## </span><span style="color: #555555;">2</span><span> (Intercept)    </span><span style="text-decoration: underline;">3</span><span>052.      477.      6.40 0.000</span><span style="text-decoration: underline;">000</span><span>072</span><span style="text-decoration: underline;">6</span><span> conf.high </span><span style="text-decoration: underline;">4</span><span>012.
</span></code></pre>
<p>We need a data frame where the lower and upper bounds of the confidence interval for <span class="math inline">\(\beta_{1}\)</span>
are in a single column.</p>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta1</span> <span class="op">&lt;-</span> <span class="va">coef_table</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"conf"</span><span class="op">)</span><span class="op">)</span>

<span class="va">beta1</span></code></pre></div>
<pre class="fansi fansi-output"><code>## <span style="color: #555555;"># A tibble: 2 x 7</span><span>
##   term  estimate std.error statistic  p.value name      value
##   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>    </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>    </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
## </span><span style="color: #555555;">1</span><span> peri      1.54     0.157      9.81 7.51</span><span style="color: #555555;">e</span><span style="color: #BB0000;">-13</span><span> conf.low   1.23
## </span><span style="color: #555555;">2</span><span> peri      1.54     0.157      9.81 7.51</span><span style="color: #555555;">e</span><span style="color: #BB0000;">-13</span><span> conf.high  1.86
</span></code></pre>
<p>Now that our data is "in shape", we can start building the plot. This plot will be constructed by
taking advantage of the fact that every <code>geom_*()</code> layer has its own <code>data</code> argument. This means
that we can use a different data set for each layer of our plot. Since we don't have a common data
set or common aesthetics that will be shared by all layers, we will not supply anything to the call
to <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. Try running the code below, layer by layer, to see how the plot is being constructed!</p>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">beta0</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="va">value</span><span class="op">)</span>, colour<span class="op">=</span><span class="st">"#3366FF"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">beta1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="va">value</span><span class="op">)</span>, colour<span class="op">=</span><span class="st">"#3366FF"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">coef_point</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">`(Intercept)`</span>, y<span class="op">=</span><span class="va">peri</span><span class="op">)</span>, colour<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">ellipse_path</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">`(Intercept)`</span>, y<span class="op">=</span><span class="va">peri</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x<span class="op">=</span><span class="st">"Intercept"</span>, y<span class="op">=</span><span class="st">"Slope"</span>,
    caption<span class="op">=</span><span class="st">"Solid line represents the boundary of the 90% confidence region. Dashed lines represent
    the boundaries of the 95% confidence intervals."</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03_files/figure-html/unnamed-chunk-54-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>Note that points contained within the ellipse are values <span class="math inline">\((\beta_{0},\,\beta_{1})\)</span> that the data
suggest are <strong>jointly</strong> reasonable for the parameters. Meanwhile, within the rectangular region
but outside of the ellipse are plausible values for the parameters when considered individually.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="lab-3-september-29.html"><span class="header-section-number">2</span> Lab 3 — September 29</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lab-5-october-13"><span class="header-section-number">3</span> Lab 5 — October 13</a></li>
<li><a class="nav-link" href="#packages"><span class="header-section-number">3.1</span> Packages</a></li>
<li><a class="nav-link" href="#the-pipe"><span class="header-section-number">3.2</span> The pipe</a></li>
<li>
<a class="nav-link" href="#multiple-linear-regression-hypothesis-testing"><span class="header-section-number">3.3</span> Multiple linear regression — hypothesis testing</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-penguins-data"><span class="header-section-number">3.3.1</span> The penguins data</a></li>
<li><a class="nav-link" href="#subsetting-the-data"><span class="header-section-number">3.3.2</span> Subsetting the data</a></li>
<li><a class="nav-link" href="#visual-check-for-linear-relationship"><span class="header-section-number">3.3.3</span> Visual check for linear relationship</a></li>
<li><a class="nav-link" href="#fit-the-model"><span class="header-section-number">3.3.4</span> Fit the model</a></li>
<li><a class="nav-link" href="#fitting-a-model-without-an-intercept"><span class="header-section-number">3.3.5</span> Fitting a model without an intercept</a></li>
<li><a class="nav-link" href="#anova-with-multiple-linear-regression-models"><span class="header-section-number">3.3.6</span> ANOVA with multiple linear regression models</a></li>
<li><a class="nav-link" href="#at-least-one-parameter-non-zero"><span class="header-section-number">3.3.7</span> At least one parameter non-zero</a></li>
<li><a class="nav-link" href="#two-parameters-non-zero"><span class="header-section-number">3.3.8</span> Two parameters non-zero</a></li>
<li><a class="nav-link" href="#one-parameter-non-zero"><span class="header-section-number">3.3.9</span> One parameter non-zero</a></li>
<li><a class="nav-link" href="#caution"><span class="header-section-number">3.3.10</span> Caution ❗</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#multiple-linear-regression-working-with-matrices-in-r"><span class="header-section-number">3.4</span> Multiple linear regression — working with matrices in R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#creating-a-matrix-in-r"><span class="header-section-number">3.4.1</span> Creating a matrix in R</a></li>
<li><a class="nav-link" href="#matrix-operations"><span class="header-section-number">3.4.2</span> Matrix operations</a></li>
<li><a class="nav-link" href="#example-question-k-page-174-selected-parts"><span class="header-section-number">3.4.3</span> Example: Question K, page 174 (selected parts)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#simple-linear-regression-simultaneous-confidence-regions"><span class="header-section-number">3.5</span> Simple linear regression — simultaneous confidence regions</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/adamoshen/3553f21/blob/main/03.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/adamoshen/3553f21/edit/main/03.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Stat 3553: Regression Modelling</strong>: Fall 2021" was written by Adam Shen. It was last built on October 20, 2021.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
